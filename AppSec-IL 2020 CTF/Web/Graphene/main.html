
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Graphene Login</title>

    <!-- Bootstrap core CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">
  </head>

  <body class="text-center">
    <div class="form-signin">
      <img class="mb-4" src="img/graphene.jpeg" alt="" width="72" height="72">
      <h1 class="h3 mb-3 font-weight-normal">Please sign in</h1>
      <div id="wrong" class="alert alert-danger" style="display:none;">Wrong username and password!</div>      
      <label for="username" class="sr-only">Email address</label>
      <input type="email" id="username" class="form-control" placeholder="Email address" required autofocus>
      <label for="password" class="sr-only">Password</label>
      <input type="password" id="password" class="form-control" placeholder="Password" required>
      <div class="checkbox mb-3">
        <label>
          <input type="checkbox" value="remember-me"> Remember me
        </label>
      </div>
      <button class="btn btn-lg btn-primary btn-block" id="signIn">Sign in</button>
      <p class="mt-5 mb-3 text-muted">&copy; 2020</p>
    </div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $("#signIn").on("click", function(){
          var username = $('#username').val();
          var password = $('#password').val();
          var query = `mutation login {login(username:"${username}", password: "${password}") {user {username}ok}}`;
          // var query = {"username": username, "password": password};
          $.ajax({
              url: '/api',
              type: 'POST',
              data: JSON.stringify({"query": query}),
              contentType: 'application/json; charset=utf-8',
              dataType: 'json',
              async: false,
              success: function(data) {
                  if(data['login'] == "failed"){
                    $("#wrong").toggle();
                  }
              }
          });          
        });
      });
    </script>
  </body>
</html>
