#!/usr/bin/env python3

from pwn import *
from Crypto.Util.number import *

proc = process('forgery.py')
proc.recvuntil("(p,g,y): ")
data = proc.recvline().decode()
data = [int(x) for x in data.split(" ")]
p, g, y = data[0], data[1], data[2]

r = g * y % p
s = (-r) % (p-1)
m = (-r) % (p-1)

signed_message = b"Cisco".hex() + long_to_bytes(m).hex().rjust(1024//4, "0")
proc.recvuntil("Answer:")
proc.sendline(signed_message)
proc.recvuntil("r:")
proc.sendline(str(r))
proc.recvuntil("s:")
proc.sendline(str(s))
proc.interactive()