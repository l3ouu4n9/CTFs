#!/usr/bin/env python3

from pwn import *

#p = process("../src/guess-secret.py")
p = remote('chals.damctf.xyz', 30308)


#for i in range(30):
#    print(str(p.recvline(), 'utf-8')[:-1])
print(p.recvuntil('HEIST)...\n'))

def trial(string):
    print(p.recvuntil('please give me your string...\n').strip())
    p.sendline(string)
    bytes_data = str(p.recvline(), 'utf-8').strip()
    b = eval(bytes_data)
    return len(b)

base_cookie = 'dam{'

key_set = '0123456789abcdef}'


while True:
    init_c_len = trial(base_cookie)
    print(init_c_len)
    arr = []
    minimum = 999999
    min_idx = -1
    for k in range(len(key_set)):
        c_len = trial(base_cookie + key_set[k])
        print("%s : %d" % (key_set[k], c_len))
        if (c_len < minimum):
            minimum = c_len
            min_idx = k

    base_cookie += key_set[min_idx]
    print("Guessed cookie: %s" % base_cookie)
    if (key_set[min_idx] == '}'):
        break
    #input("PRESS ENTER TO CONTINUE")

