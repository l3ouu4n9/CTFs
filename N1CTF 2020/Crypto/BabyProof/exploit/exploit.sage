import json
from Crypto.Util.number import long_to_bytes
qs, cs, rs = json.load(open("data", "r"))
# HNP
N = 50
M = matrix(ZZ, N+2, N+2)
# q1
# q2
# ...
# qn #c1c2...cn 1 # r1 r2 ... rn 2^248

for i in range(N):
    M[i,i]  = qs[i] # qi
    M[-2,i] = cs[i] # ci
    M[-1,i] = rs[i] # ri
M[-2,-2] = 1
M[-1,-1] = 2^248
M_lll = M.LLL()
x = M_lll[0,-2]
print(long_to_bytes(x))
# b'n1ctf{S0me_kn0wl3dg3_is_leak3d}'