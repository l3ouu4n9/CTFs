# Source: https://a-kooli.me/post/cybersecurityrumble-ctf-2020-dlog/

from Crypto.Util.number import inverse
from pwn import remote

HOST = "chal.cybersecurityrumble.de"
PORT = 31782

P = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f
# b = 0 => y^2 = x^3 (pick a random point meet this formula)
gx = 4
gy = 8

p = remote(HOST, PORT)
p.recvuntil("x: ")
p.sendline(str(gx))
p.recvuntil("y: ")
p.sendline(str(gy))
p.recvuntil("(")
px = int(p.recvuntil(',')[:-1])
py = int(p.recvuntil(')')[:-1])
#print(px,py)
p.recvuntil("secret: ")
g = gx * inverse(gy, P) % P
y = px * inverse(py, P) % P
d = inverse(g, P) * y % P
#print(d)
p.sendline(str(d))
p.interactive()